<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RuneScape Clone (No Server Required)</title>
    <style>
        /* Basic Reset */
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: 'Verdana', sans-serif;
            user-select: none;
        }

        canvas {
            display: block;
        }

        #ui-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        /* RS Style UI */
        .rs-panel {
            background-color: #5b4a3e;
            border: 3px solid #382e26;
            border-radius: 4px;
            box-shadow: inset 0 0 10px #2b2319;
            pointer-events: auto;
        }

        #inventory {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 220px;
            height: 300px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(7, 1fr);
            gap: 4px;
            padding: 8px;
        }

        .inv-slot {
            background-color: #4a3b32;
            border: 1px solid #2b2319;
            box-shadow: inset 1px 1px 2px #000;
        }

        .inv-item {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 10px;
            color: white;
            cursor: pointer;
        }

        #chatbox {
            position: absolute;
            bottom: 10px;
            left: 10px;
            width: 400px;
            height: 150px;
            color: white;
            font-family: monospace;
            overflow-y: auto;
            padding: 5px;
            background-color: rgba(0, 0, 0, 0.6);
            border: 2px solid #5b4a3e;
        }

        .chat-msg {
            margin: 2px 0;
            text-shadow: 1px 1px 0 #000;
        }

        .chat-msg.system {
            color: #ffff00;
        }

        .chat-msg.action {
            color: #00ffff;
        }

        .chat-msg.normal {
            color: #ffffff;
        }

        #xp-tracker {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #ffff00;
            padding: 8px;
            font-weight: bold;
            text-shadow: 1px 1px 0 #000;
        }

        button {
            background-color: #5b4a3e;
            color: white;
            border: 2px solid #382e26;
            padding: 5px 10px;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            background-color: #6d594b;
        }
    </style>
    <!-- Load Three.js via cdnjs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script>
</head>

<body>
    <div id="ui-container">
        <div id="xp-tracker" class="rs-panel">
            <div>Woodcutting: <span id="xp-wc">1</span></div>
            <div>Mining: <span id="xp-mine">1</span></div>
        </div>
        <button onclick="toggleCustomization()"
            style="position:absolute; top:10px; right:10px; pointer-events:auto;">Customize Character</button>
        <div id="chatbox">Welcome to RuneScape Clone!</div>
        <div id="inventory" class="rs-panel">
            <!-- 28 slots -->
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
            <div class="inv-slot"></div>
        </div>
    </div>

    <script>
        // --- TEXTURE GENERATOR ---
        const TextureFactory = {
            createCanvas: function (width, height) {
                const canvas = document.createElement('canvas');
                canvas.width = width;
                canvas.height = height;
                return canvas;
            },
            createNoise: function (colorBase, colorNoise, scale = 1) {
                const size = 512; // Higher res textures
                const canvas = this.createCanvas(size, size);
                const ctx = canvas.getContext('2d');

                // Fill base
                ctx.fillStyle = colorBase;
                ctx.fillRect(0, 0, size, size);

                // Add noise
                for (let i = 0; i < 10000 * scale; i++) {
                    const x = Math.random() * size;
                    const y = Math.random() * size;
                    const w = Math.random() * 2 * scale;
                    const h = Math.random() * 2 * scale;
                    ctx.fillStyle = colorNoise;
                    ctx.globalAlpha = 0.2;
                    ctx.fillRect(x, y, w, h);
                }

                const tex = new THREE.CanvasTexture(canvas);
                tex.wrapS = THREE.RepeatWrapping;
                tex.wrapT = THREE.RepeatWrapping;
                return tex;
            },
            createWood: function () {
                const size = 512;
                const canvas = this.createCanvas(size, size);
                const ctx = canvas.getContext('2d');

                ctx.fillStyle = '#5c4033';
                ctx.fillRect(0, 0, size, size);

                // Grain
                for (let i = 0; i < 100; i++) {
                    ctx.strokeStyle = '#3e2b1f';
                    ctx.lineWidth = 2;
                    ctx.globalAlpha = 0.4;
                    ctx.beginPath();
                    ctx.moveTo(Math.random() * size, 0);
                    ctx.bezierCurveTo(Math.random() * size, size / 3, Math.random() * size, size * 2 / 3, Math.random() * size, size);
                    ctx.stroke();
                }
                return new THREE.CanvasTexture(canvas);
            },
            createBricks: function () {
                const size = 512;
                const canvas = this.createCanvas(size, size);
                const ctx = canvas.getContext('2d');

                ctx.fillStyle = '#777';
                ctx.fillRect(0, 0, size, size);

                ctx.strokeStyle = '#444';
                ctx.lineWidth = 4;

                // Horizontal lines
                for (let y = 0; y <= size; y += 32) {
                    ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(size, y); ctx.stroke();
                }
                // Vertical lines (staggered)
                for (let y = 0; y < size; y += 32) {
                    const offset = (y / 32) % 2 === 0 ? 0 : 16;
                    for (let x = offset; x <= size; x += 32) {
                        ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x, y + 32); ctx.stroke();
                    }
                }

                const tex = new THREE.CanvasTexture(canvas);
                tex.wrapS = THREE.RepeatWrapping;
                tex.wrapT = THREE.RepeatWrapping;
                return tex;
            }
        };

        // Pre-generate textures
        const textures = {
            grass: TextureFactory.createNoise('#2d3623', '#4a5d32', 2),
            water: TextureFactory.createNoise('#3a6a8a', '#4fa4d4', 2),
            stone: TextureFactory.createNoise('#555', '#333', 2),
            wood: TextureFactory.createWood(),
            leaves: TextureFactory.createNoise('#1e3b1e', '#2f5e2f', 1),
            wall: TextureFactory.createBricks(),
            dirt: TextureFactory.createNoise('#5b4a3e', '#3e2b1f', 1),
            skin: TextureFactory.createNoise('#ffccaa', '#eebb99', 0.5),
            shirt: TextureFactory.createNoise('#224488', '#112244', 0.5),
            pants: TextureFactory.createNoise('#333333', '#111111', 0.5)
        };

        textures.grass.repeat.set(10, 10);
        textures.water.repeat.set(2, 10);
        textures.wall.repeat.set(1, 3);
    </script>

    <!-- Load Game Modules -->
    <script src="js/ui.js"></script>
    <script src="js/skills.js"></script>
    <script src="js/character_model.js"></script>
    <script src="js/world.js"></script>
    <script src="js/player.js"></script>
    <script src="js/npc.js"></script>
    <script src="js/interaction.js"></script>
    <script src="js/game.js"></script>
</body>

</html>